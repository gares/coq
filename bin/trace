#!/bin/sh

usage(){
	echo "usage: $0 (on|off) letter file.ml"
	echo "Example: $0 on D kernel/conversion.ml"
	exit 1
}

# This sed line reads the whole file into the pattern space
#    :a; N; $!ba;
# :a is the label, N glues the current line; b branches
# to a if not EOF

if [ $# -lt 3 ]; then usage; fi

case $1 in
on) 
	sed -i '
        :a; N; $!ba;
	s/(\*'$2'\* /(*'$2'<*)/g
	s/ \*'$2'\*)/(*'$2'>*)/g
	' $3
;;
off)
	sed -i '
        :a; N; $!ba;
	s/(\*'$2'<\*)/(*'$2'* /g
	s/(\*'$2'>\*)/ *'$2'*)/g
	' $3
;;
*)
	usage
;;
esac
